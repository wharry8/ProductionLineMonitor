# 小车移动

小车的速度根据生产线小车实际的速度进行调整, 应该快于生产线小车的速度, 保证动画小车比实际小车率先到达目的地.
```
线程1
  根据小车的速度和方向, 更新小车的位置
  如果小车到达目的地
    修改小车的速度为0
线程2
  如果小车经过某个位置的线圈为1
    如果小车还未到达目的地
      如果小车的速度为0
        修改小车的速度
      如果小车的目的地不是该位置
        修改小车的目的地
      判断目的地的方向在左边还是右边
      如果小车的速度方向与目的地方向不一致


        修改小车的方向
    如果小车已经到达目的地
      如果小车的速度不为0
        修改小车的速度为0
```

# 小车放下箱子, 获取箱子

```
线程1
  不需要处理这个动作

线程2
放下箱子动作
  这个动作必须根据连续两组信号的状态来完成
  如果前一个状态小车出钩, 当前状态小车回钩, 那么小车放下箱子
  (动画小车比实际小车提前到达目的地是该动作能完成的前提)

获取箱子动作:
  这个动作必须根据连续两组信号的状态来完成
  如果前一个状态小车回钩, 当前状态小车出钩, 那么小车获取箱子
  (动画小车比实际小车提前到达目的地是该动作能完成的前提)
```

# 料盒上升和下降

```
线程1
  设定料盒的下料位和上料位.
  根据料盒的速度更新料盒位置
  如果料盒到达目的地(上料位或者下料位)
    修改料盒的速度大小为0

线程2
  方案1:
  信号:
    1. 上料盒到位 到位信号
    2. 下料盒到位 到位信号
  如果料盒上料位到位
    如果料盒还未到达上料位
      如果料盒的速度方向不是上料位
        修改料盒的速度方向
      如果料盒的速度大小为0
        修改料盒的速度大小
  如果料盒下料位到位
    同上
  优点: 简单, 容易实现 
  缺点: 由于采用后动的方式, 可能出现动画料盒未到位, 程序已经读取到机械臂取料的信号, 会出现错误.

  方案2:
  信号:
    1. 小车放下箱子 (推测之后的动作是料盒上升)
    2. 下料盒到位 
  如果小车放子箱子
    修改箱子的目的为上料位
    修改箱子的速度大小
    修改箱子的速度方向为向上
  如果下料盒到位
    如果料盒还未到达下料位
      如果料盒的速度方向不是下料位
        修改料盒的速度方向
      如果料盒的速度大小为0
        修改料盒的速度大小
    如果料盒已经到达下料位
      不需要任何操作
      (需要修改的数据已经由线程1修改)
  优点: 料盒上升参考了其他信号, 实现前动效果, 动画料盒提前到达指定位置, 不会出现动画料盒还未到达指定位置, 机械臂就对料盒进行操作的情况.
  缺点: 提前让料盒上升的判断条件是推测的, 可能与实际情况不一致.
```

# 机械臂移动
```
上下的效果用缩小/扩大来实现
设定好初始大小和到达上料位时的大小, 上升时变大, 下降时变小.
设定好左/右放料位的位置, 取料位的位置

线程1
  根据机械臂的速度修改机械臂的位置
  如果机械臂到达目的地
    修改机械臂的速度为0
  如果机械臂横移到左放料位
    修改原点为左取料位
    (在横移到取料位时用来判断速度方向)
  如果机械臂横移到右放料位
    修改原点为右放料位
    (在横移到取料位时用来判断速度方向)
  如果机械臂横移到取料位
    修改原点为取料位

线程2
  如果上下到等待位=1
    如果还未到达等待位
      修改速度大小
      修改速度方向
  如果上下到取料位=1
    如果还未到达取料位
      修改速度大小
      修改速度方向
  如果上下到放料位=1
    如果还未到达放料位
      修改速度大小
      修改速度方向
  如果横移到左放料位=1
    如果还未到达左放料位
      修改速度大小
      修改速度方向
  如果横移到取料位=1
    如果起始位置是在左放料位
      如果还未到达取料位
        修改速度方向
        修改速度大小
    如果起始位置是右放料位
      如果还未到达取料位
        修改速度方向向左
        修改速度大小
```